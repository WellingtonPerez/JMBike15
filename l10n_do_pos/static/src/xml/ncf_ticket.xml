<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
    <t t-name="OrderReceipt" t-inherit="point_of_sale.OrderReceipt" t-inherit-mode="extension" owl="1">

        <xpath expr="//div[hasclass('pos-receipt')]" position="replace">
            <div class="pos-receipt" style="font-family: 'Inconsolata';">
                <div class="pos-center-align">
                    <t t-set="sale_fiscal_data"
                        t-value="env.pos.get_sale_fiscal_type()"/>

                    <t t-if='receipt.company.logo'>
                        <img style="width: 30%;display: block; margin:auto; padding:0px;" t-att-src='receipt.company.logo' alt="Logo"/>
                    </t>
                    <div style="font-size: 15px; padding-top:1px"><t t-esc="receipt.company.name" /></div>
                    <div style="font-size: 12px; border-bottom: 1px dashed black;">
                        <div>RNC: <t t-esc="receipt.company.vat" /> <span>TEL. <t t-esc="receipt.company.phone" /></span><br/></div>
                        <t t-if='receipt.company.email'><span>EMAIL: <t t-esc="receipt.company.email" /></span><br/></t>
                        <t t-if='receipt.company.website'><span>WEB: <t t-esc="receipt.company.website" /></span></t>
                    </div>
                    <t t-set="mult" t-value="1"/>
                    <h4 size="double-height" style="margin:5px; padding:0px;">
                        <t t-set="prov" t-value="0" />
                        <t t-set="order" t-value="env.pos.get_order()" />
                        <t t-if="order.provisional or !order.consecutivo or !order.number_electronic">
                            <t t-set="prov" t-value="1" />
                        </t> 
                        <t t-if="receipt.return_order_id">
                            <span>Nota de Cr√©dito</span>
                            <br/>
                        </t>
                        <t t-else="">
                            <span><strong>Factura de
                                <t t-esc="sale_fiscal_data.sale_fiscal_type"/></strong>
                            </span>
                            <br/>
                        </t>
                        <span style="font-size:15px;"><strong>NCF:</strong>
                            <t t-esc="sale_fiscal_data.ncf"/>
                        </span>
                        <br/> 
                        <t t-if="receipt.return_order_id">
                            <br/>
                        <span>NCF Modificado:
                                <t t-esc="receipt.origin_ncf"/>
                        </span>
                        </t>
                       <span style="font-size:15px;"><strong> NCF Vence:</strong> 31/12/2023</span>
                        <br/>
                    </h4>
                    <div class="pos-center" style="font-size: 13px;">
                        <t t-esc="receipt.name"/>
                        <span>   </span>
                        <t t-if="order.formatted_validation_date">
                            <t t-esc="order.formatted_validation_date"/>
                        </t>
                        <t t-else="">
                            <t t-esc="order.validation_date"/>
                        </t> 
                    </div>
                    <t t-if="receipt.header">
                        <div style='text-align:center'>
                            <t t-esc="receipt.header" />
                        </div>
                        <br/>
                    </t>
                    <div class="pos-center-align">
                        <t t-if="receipt.client">
                            CLIENTE: <t t-esc="receipt.client.name"/><br/>
                            RNC/CED..: <t t-esc="receipt.client.vat"/><br/>
                            EMAIL: <t t-esc="receipt.client.email"/><br/>
                        </t>
                        <t t-if='receipt.cashier'>
                            <div class='cashier'>
                                SERVIDO(A):<t t-esc='receipt.cashier' />
                            </div>
                        </t>
                    </div>
                </div>
            
                <!-- Orderlines -->
                <div style="text-align:center; font-size: 75%; border-top: 1px dashed black;padding-top: 5px;padding-bottom: 5px;">
                    <table style="width: 100%;">
                        <tr style="border-bottom: 1px dashed black;font-size:15px;">
                            <th width="36%" style="text-align:left; ">Producto</th>
                            <th width="8%">Ctd</th>
                            <th width="28%" style="text-align: center;">Precio</th>
                            <th width="28%">Monto</th>
                        </tr>
                        <tr t-foreach="receipt.orderlines" t-as="line" style="font-size:15px; border-bottom: 1px dashed black;">
                            <td style="text-align: left;">
                                <div style="padding-top: 5;padding-bottom: 5px;">
                                    <span t-esc='line.product_name_wrapped[0]'/>
                                    <t t-if='line.discount !== 0'>
                                        <h5 style="margin-top: 0%;margin-bottom: 0%;font-size: 12px;color: #848484;">
                                            <t t-esc='line.discount' />% Descuento
                                        </h5>
                                    </t>
                                </div>
                            </td>
                            <td style="text-align: center"><span t-esc="line.quantity"/><span t-if='line.unit_name !== "Unidades"' t-esc='line.unit_name'/></td>
                            <td style="text-align: center"><span t-esc="env.pos.format_currency_no_symbol(line.price)"/></td>
                            <td style="text-align: center"><span t-esc='env.pos.format_currency_no_symbol(line.price_display)'/></td>
                        </tr>
                    </table>
                </div>
                <br/>
                <table style="width: 100%;">
                    <tr>
                        <td>Subtotal:</td>
                        <td class="pos-receipt-right-align">
                            <t t-esc="env.pos.format_currency(order.get_total_without_tax())"/>
                        </td>
                    </tr>
                    <t t-foreach="order.get_tax_details()" t-as="taxdetail">
                        <tr>
                            <td><t t-esc="taxdetail.name" /></td>
                            <td class="pos-receipt-right-align">
                                <t t-esc="env.pos.format_currency(taxdetail.amount)" />
                            </td>
                        </tr>
                    </t>
                    <tr>
                        <t t-if="order.get_total_discount() > 0">
                            <td>Descuento:</td>
                            <td class="pos-receipt-right-align">
                                <t t-esc="env.pos.format_currency(order.get_total_discount())"/>
                            </td>
                        </t>
                    </tr>
                    <tr style="font-size: 20px;margin: 5px; border-bottom: 1px dashed black;">
                        <td>Total:</td>
                        <td class="pos-receipt-right-align">
                            <t t-esc="env.pos.format_currency(order.get_total_with_tax())"/>
                        </td>
                    </tr>
                </table>
                <br />
                <table style="width: 100%;">
                    <t t-foreach="paymentlines" t-as="line">
                        <tr>
                            <td>
                                <t t-esc="line.name"/>
                            </td>
                            <td class="pos-receipt-right-align">
                                <t t-esc="env.pos.format_currency(line.get_amount())"/>
                            </td>
                        </tr>
                    </t>
                </table>
                <br />
                <table style="width: 100%;">
                    <tr><td>Cambio:</td><td class="pos-receipt-right-align">
                        <t t-esc="env.pos.format_currency(order.get_change())"/>
                        </td></tr>
                </table>
                <div class="pos-center-align" style="margin: 5px; padding-bottom:1px; border-top: 1px dashed black;">
                    <t t-if='receipt.table'>
                     <b>Mesa: <t t-esc="env.pos.table.name"/></b>
                    </t> 
                </div> 
                <t t-if="receipt.footer">
                    <div style='text-align:center'>
                        <t t-esc="receipt.footer" />
                    </div>
                </t>
                <div style="text-align: center; padding:0px; margin:0px;" t-if="order.pos.config.receipt_logo">
                    <img style="margin: 1px;width: 75;height: 75px;" t-att-src="receipt.barcode"/>
                </div>
            </div>
        </xpath>
        
    </t>
</templates>